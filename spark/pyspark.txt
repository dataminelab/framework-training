
# Start pyspark

pyspark

wordcounts = sc.textFile('s3://testbucket-radek/hamlet.txt') \
        .map( lambda x: x.replace(',',' ').replace('.',' ').replace('-',' ').lower()) \
        .flatMap(lambda x: x.split()) \
        .map(lambda x: (x, 1)) \
        .reduceByKey(lambda x,y:x+y) \
        .map(lambda x:(x[1],x[0])) \
        .sortByKey(False) 
wordcounts.take(10)

# Submit SimpleApp.py

spark-submit --master local[4] SimpleApp.py

# PySpark and SQL

spark-submit --master local[4] SparkSql.py

# Few options for adding spark step to the EMR cluster

aws emr add-steps --cluster-id <your-cluster-job-id> --steps Name=Python Job,Jar=http://s3://elasticmapreduce/libs/script-runner/script-runner.jar,Args=[/home/hadoop/spark/bin/spark-submit,--deploy-mode,cluster,--master,yarn,s3://my_bucket/path/pythonjob.py,<comma separated list of arguments for your app>],ActionOnFailure=CONTINUE

Or:
http://docs.aws.amazon.com/ElasticMapReduce/latest/DeveloperGuide/emr-spark-submit-step.html

Another option with Data Pipeline:
https://forums.aws.amazon.com/thread.jspa?threadID=221452

